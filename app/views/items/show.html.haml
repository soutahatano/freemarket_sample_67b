= render 'shared/main_header'
.item-show
  .item-show__page
    .item-show__page__box
      .item-show__page__box__name
        = @item.name
      .item-show__page__box__content
        .item-show__page__box__content__img
          #picturepreview
            = image_tag @item.pictures[0].picture.url, width: "290px", height: "290px"
            - if @item.soldout == "true"
              .top-category__lists__list1__border-box
              .top-category__lists__list1__text-box
                .top-category__lists__list1__text-box__sold-out
                  SOLD
          .picture
            - @item.pictures.each do |picture|
              = image_tag picture.picture.url, width: "54.3px", height: "54.3px", class: "hoge"
        .item-show__page__box__content__table
          %table{border: "1"}
            %tr
              %th å‡ºå“è€…
              %td
                -# = link_to new_signup_path do
                = @item.user.nickname
            %tr
              %th ã‚«ãƒ†ã‚´ãƒªãƒ¼
              %td
                = @item.category.name
            %tr
              %th ãƒ–ãƒ©ãƒ³ãƒ‰
              %td
                = @item.brand
            %tr
              %th å•†å“ã®çŠ¶æ…‹
              %td
                = @item.status.name
            %tr
              %th é…é€æ–™ã®è² æ‹…
              %td
                = @item.delivery.deliverycharge.name
            %tr
              %th é…é€å…ƒåœ°åŸŸ
              %td
                = @item.user.address.prefecture.name
                = @item.user.address.city
            %tr
              %th ç™ºé€æ—¥ã®ç›®å®‰
              %td
                = @item.delivery.deliveryday.name
      .item-show__page__box__price-box
        .item-show__page__box__price-box__price
          Â¥
          = @item.price
        .item-show__page__box__price-box__tax
          (ç¨è¾¼)
        -if @item.delivery.deliverycharge.name == "é€æ–™è¾¼ã¿(å‡ºå“è€…è² æ‹…)"
          .item-show__page__box__price-box__shipping-fee
            é€æ–™è¾¼ã¿
        -else
          .item-show__page__box__price-box__shipping-fee
            é€æ–™åˆ¥
      - if @item.user == current_user
        = link_to edit_item_path(@item) do
          .item-show__page__box__buy-btn
            ç·¨é›†
        = link_to item_path(@item), method: :delete do
       
          .item-show__page__box__buy-btn
            å‰Šé™¤
      - else 
        = link_to buy_item_path(@item) do
          .item-show__page__box__buy-btn
            è³¼å…¥ç”»é¢ã«é€²ã‚€
      .item-show__page__box__text
        ã“ã®å•†å“ã¯FURIMAä¾¿ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€ã‚¢ãƒ—ãƒªã‹ã‚‰ã®ã¿è³¼å…¥ã§ãã¾ã™ã€‚
      .item-show__page__box__description
        .item-show__page__box__description__text
          [å•†å“èª¬æ˜]
          = @item.text
        .item-show__page__box__description__container
          .item-show__page__box__description__container__left-box
            .item-show__page__box__description__container__left-box__good-btn
              - if @item.favorite?(current_user)
                %i.fa.fa-heart.red{data:{ids:{"item": @item.id,"user": current_user.id}}}
              - else
                %i.fa.fa-heart{data:{ids:{"item": @item.id,"user": current_user.id}}}
              %p.favorite-text ã„ã„ã­ 
            .item-show__page__box__description__container__left-box__report-btn
              ğŸ‡¯ğŸ‡µ  ä¸é©åˆ‡ãªå•†å“ã®å ±å‘Š
          .item-show__page__box__description__container__lock-text
            ğŸ”‘  ã‚ã‚“ã—ã‚“ãƒ»ã‚ã‚“ãœã‚“ã¸ã®å–ã‚Šçµ„ã¿
    .item-show__page__show-message
      .item-show__page__show-message__container
        .item-show__page__show-message__container__content
          .item-show__page__show-message__container__content__text
            ç›¸æ‰‹ã®ã“ã¨ã‚’è€ƒãˆä¸å¯§ãªã‚³ãƒ¡ãƒ³ãƒˆã‚’å¿ƒãŒã‘ã¾ã—ã‚‡ã†ã€‚ä¸å¿«ãªè¨€è‘‰é£ã„ãªã©ã¯åˆ©ç”¨åˆ¶é™ã‚„é€€ä¼šå‡¦åˆ†ã¨ãªã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚
          .item-show__page__show-message__container__content__text-box
          .item-show__page__show-message__container__content__comment
            ã‚³ãƒ¡ãƒ³ãƒˆã™ã‚‹
    .item-show__page__show-icons
      .item-show__page__show-icons__container
        .item-show__page__show-icons__container__facebook
          %i.fab.fa-twitter
        .item-show__page__show-icons__container__twitter 
          %i.fab.fa-facebook
        .item-show__page__show-icons__container__pinterest
          %i.fab.fa-line
    .item-show__page__other-item
      .item-show__page__other-item__text
        = @item.user.nickname
        ã•ã‚“ã®ãã®ä»–ã®å‡ºå“
      .item-show__page__other-item__lists
        - @items.each do |item|
          = link_to item_path(item) do
            .item-show__page__other-item__lists__list1
              .item-show__page__other-item__lists__list1__img
                = image_tag item.pictures[0].picture.url,size: "188x188"
                - if item.soldout == "true"
                  .top-category__lists__list1__border-box
                  .top-category__lists__list1__text-box
                    .top-category__lists__list1__text-box__sold-out
                      SOLD
              .item-show__page__other-item__lists__list1__text
                .item-show__page__other-item__lists__list1__text__name
                  = item.name
                .item-show__page__other-item__lists__list1__text__low-box
                  .item-show__page__other-item__lists__list1__text__low-box__price
                    = item.price
                  .item-show__page__other-item__lists__list1__text__low-box__good
                    â™¡ 2
      .item-show__page__low-text
        .item-show__page__low-text__left
          FURIMA
        .item-show__page__low-text__right
          ï¼
          = @item.name
= render 'shared/main_footer'

:javascript
  $(function(){
    $(document).on("click",".fa-heart",function(){
      var item = $(this).data("ids-item");
      var user = $(this).data("ids-user");
      if($(this).hasClass("red")){
        $.ajax({
          type: 'DELETE',
          url: `/favorites/${item}`,
          data: {item_id: item, user_id: user},
          dataType: 'json'
        })
        .done(function(){
          console.log('æˆåŠŸ');
          $(".fa-heart").removeClass("red");
        })
        .fail(function(){
          console.log('å¤±æ•—');
        });
      }else{
        $.ajax({
          type: 'POST',
          url: `/favorites`,
          data: {item_id: item},
          dataType: 'json'
        })
        .done(function(){
          console.log('æˆåŠŸ');
          $(".fa-heart").addClass("red");
        })
        .fail(function(){
          console.log('å¤±æ•—');
        });
      }
    });
  });